       # This file is dual licensed under the terms of the Apache License, Version
       # 2.0, and the BSD License. See the LICENSE file in the root of this repository
       # for complete details.
       
    1: from __future__ import annotations
       
    1: import abc
    1: import typing
       
    1: from cryptography.hazmat.bindings._rust import openssl as rust_openssl
    1: from cryptography.hazmat.primitives import _serialization, hashes
    1: from cryptography.hazmat.primitives.asymmetric import utils as asym_utils
    1: from cryptography.utils import Buffer
       
       
    2: class DSAParameters(metaclass=abc.ABCMeta):
    1:     @abc.abstractmethod
    1:     def generate_private_key(self) -> DSAPrivateKey:
               """
               Generates and returns a DSAPrivateKey.
               """
       
    1:     @abc.abstractmethod
    1:     def parameter_numbers(self) -> DSAParameterNumbers:
               """
               Returns a DSAParameterNumbers.
               """
       
       
    1: DSAParametersWithNumbers = DSAParameters
    1: DSAParameters.register(rust_openssl.dsa.DSAParameters)
       
       
    2: class DSAPrivateKey(metaclass=abc.ABCMeta):
    1:     @property
    1:     @abc.abstractmethod
    1:     def key_size(self) -> int:
               """
               The bit length of the prime modulus.
               """
       
    1:     @abc.abstractmethod
    1:     def public_key(self) -> DSAPublicKey:
               """
               The DSAPublicKey associated with this private key.
               """
       
    1:     @abc.abstractmethod
    1:     def parameters(self) -> DSAParameters:
               """
               The DSAParameters object associated with this private key.
               """
       
    1:     @abc.abstractmethod
    1:     def sign(
               self,
               data: Buffer,
               algorithm: asym_utils.Prehashed | hashes.HashAlgorithm,
           ) -> bytes:
               """
               Signs the data
               """
       
    1:     @abc.abstractmethod
    1:     def private_numbers(self) -> DSAPrivateNumbers:
               """
               Returns a DSAPrivateNumbers.
               """
       
    1:     @abc.abstractmethod
    1:     def private_bytes(
               self,
               encoding: _serialization.Encoding,
               format: _serialization.PrivateFormat,
               encryption_algorithm: _serialization.KeySerializationEncryption,
           ) -> bytes:
               """
               Returns the key serialized as bytes.
               """
       
    1:     @abc.abstractmethod
    1:     def __copy__(self) -> DSAPrivateKey:
               """
               Returns a copy.
               """
       
       
    1: DSAPrivateKeyWithSerialization = DSAPrivateKey
    1: DSAPrivateKey.register(rust_openssl.dsa.DSAPrivateKey)
       
       
    2: class DSAPublicKey(metaclass=abc.ABCMeta):
    1:     @property
    1:     @abc.abstractmethod
    1:     def key_size(self) -> int:
               """
               The bit length of the prime modulus.
               """
       
    1:     @abc.abstractmethod
    1:     def parameters(self) -> DSAParameters:
               """
               The DSAParameters object associated with this public key.
               """
       
    1:     @abc.abstractmethod
    1:     def public_numbers(self) -> DSAPublicNumbers:
               """
               Returns a DSAPublicNumbers.
               """
       
    1:     @abc.abstractmethod
    1:     def public_bytes(
               self,
               encoding: _serialization.Encoding,
               format: _serialization.PublicFormat,
           ) -> bytes:
               """
               Returns the key serialized as bytes.
               """
       
    1:     @abc.abstractmethod
    1:     def verify(
               self,
               signature: Buffer,
               data: Buffer,
               algorithm: asym_utils.Prehashed | hashes.HashAlgorithm,
           ) -> None:
               """
               Verifies the signature of the data.
               """
       
    1:     @abc.abstractmethod
    1:     def __eq__(self, other: object) -> bool:
               """
               Checks equality.
               """
       
    1:     @abc.abstractmethod
    1:     def __copy__(self) -> DSAPublicKey:
               """
               Returns a copy.
               """
       
       
    1: DSAPublicKeyWithSerialization = DSAPublicKey
    1: DSAPublicKey.register(rust_openssl.dsa.DSAPublicKey)
       
    1: DSAPrivateNumbers = rust_openssl.dsa.DSAPrivateNumbers
    1: DSAPublicNumbers = rust_openssl.dsa.DSAPublicNumbers
    1: DSAParameterNumbers = rust_openssl.dsa.DSAParameterNumbers
       
       
    1: def generate_parameters(
           key_size: int, backend: typing.Any = None
       ) -> DSAParameters:
>>>>>>     if key_size not in (1024, 2048, 3072, 4096):
>>>>>>         raise ValueError("Key size must be 1024, 2048, 3072, or 4096 bits.")
       
>>>>>>     return rust_openssl.dsa.generate_parameters(key_size)
       
       
    1: def generate_private_key(
           key_size: int, backend: typing.Any = None
       ) -> DSAPrivateKey:
>>>>>>     parameters = generate_parameters(key_size)
>>>>>>     return parameters.generate_private_key()
