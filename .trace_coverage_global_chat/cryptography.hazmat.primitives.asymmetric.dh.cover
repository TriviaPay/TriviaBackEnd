       # This file is dual licensed under the terms of the Apache License, Version
       # 2.0, and the BSD License. See the LICENSE file in the root of this repository
       # for complete details.
       
    1: from __future__ import annotations
       
    1: import abc
       
    1: from cryptography.hazmat.bindings._rust import openssl as rust_openssl
    1: from cryptography.hazmat.primitives import _serialization
       
    1: generate_parameters = rust_openssl.dh.generate_parameters
       
       
    1: DHPrivateNumbers = rust_openssl.dh.DHPrivateNumbers
    1: DHPublicNumbers = rust_openssl.dh.DHPublicNumbers
    1: DHParameterNumbers = rust_openssl.dh.DHParameterNumbers
       
       
    2: class DHParameters(metaclass=abc.ABCMeta):
    1:     @abc.abstractmethod
    1:     def generate_private_key(self) -> DHPrivateKey:
               """
               Generates and returns a DHPrivateKey.
               """
       
    1:     @abc.abstractmethod
    1:     def parameter_bytes(
               self,
               encoding: _serialization.Encoding,
               format: _serialization.ParameterFormat,
           ) -> bytes:
               """
               Returns the parameters serialized as bytes.
               """
       
    1:     @abc.abstractmethod
    1:     def parameter_numbers(self) -> DHParameterNumbers:
               """
               Returns a DHParameterNumbers.
               """
       
       
    1: DHParametersWithSerialization = DHParameters
    1: DHParameters.register(rust_openssl.dh.DHParameters)
       
       
    2: class DHPublicKey(metaclass=abc.ABCMeta):
    1:     @property
    1:     @abc.abstractmethod
    1:     def key_size(self) -> int:
               """
               The bit length of the prime modulus.
               """
       
    1:     @abc.abstractmethod
    1:     def parameters(self) -> DHParameters:
               """
               The DHParameters object associated with this public key.
               """
       
    1:     @abc.abstractmethod
    1:     def public_numbers(self) -> DHPublicNumbers:
               """
               Returns a DHPublicNumbers.
               """
       
    1:     @abc.abstractmethod
    1:     def public_bytes(
               self,
               encoding: _serialization.Encoding,
               format: _serialization.PublicFormat,
           ) -> bytes:
               """
               Returns the key serialized as bytes.
               """
       
    1:     @abc.abstractmethod
    1:     def __eq__(self, other: object) -> bool:
               """
               Checks equality.
               """
       
    1:     @abc.abstractmethod
    1:     def __copy__(self) -> DHPublicKey:
               """
               Returns a copy.
               """
       
       
    1: DHPublicKeyWithSerialization = DHPublicKey
    1: DHPublicKey.register(rust_openssl.dh.DHPublicKey)
       
       
    2: class DHPrivateKey(metaclass=abc.ABCMeta):
    1:     @property
    1:     @abc.abstractmethod
    1:     def key_size(self) -> int:
               """
               The bit length of the prime modulus.
               """
       
    1:     @abc.abstractmethod
    1:     def public_key(self) -> DHPublicKey:
               """
               The DHPublicKey associated with this private key.
               """
       
    1:     @abc.abstractmethod
    1:     def parameters(self) -> DHParameters:
               """
               The DHParameters object associated with this private key.
               """
       
    1:     @abc.abstractmethod
    1:     def exchange(self, peer_public_key: DHPublicKey) -> bytes:
               """
               Given peer's DHPublicKey, carry out the key exchange and
               return shared key as bytes.
               """
       
    1:     @abc.abstractmethod
    1:     def private_numbers(self) -> DHPrivateNumbers:
               """
               Returns a DHPrivateNumbers.
               """
       
    1:     @abc.abstractmethod
    1:     def private_bytes(
               self,
               encoding: _serialization.Encoding,
               format: _serialization.PrivateFormat,
               encryption_algorithm: _serialization.KeySerializationEncryption,
           ) -> bytes:
               """
               Returns the key serialized as bytes.
               """
       
    1:     @abc.abstractmethod
    1:     def __copy__(self) -> DHPrivateKey:
               """
               Returns a copy.
               """
       
       
    1: DHPrivateKeyWithSerialization = DHPrivateKey
    1: DHPrivateKey.register(rust_openssl.dh.DHPrivateKey)
